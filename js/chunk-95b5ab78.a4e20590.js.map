{"version":3,"sources":["webpack:///./src/views/login/components/LoginCallbackPatch.vue?5076","webpack:///./src/views/login/components/LoginCallbackBindPhone.vue?d9b1","webpack:///./src/views/login/LoginCallbackPage.vue?3ffc","webpack:///./src/views/login/LoginCallbackPage.vue","webpack:///./src/views/login/components/LoginCallbackBindPhone.vue","webpack:///./src/views/login/components/LoginCallbackBindPhone.vue?1127","webpack:///./src/views/login/components/LoginCallbackPatch.vue","webpack:///./src/views/login/components/LoginCallbackPatch.vue?a3dd","webpack:///./src/views/login/LoginCallbackPage.vue?38ed"],"names":["class","loading","isBind","hasAccount","href","unionId","type","value","onSubmit","src","avatar","alt","nickname","mobileField","placeholder","mobileError","codeField","getMsgCode","isActive","count","codeError","name","props","String","setup","useQQUserInfo","useLoginAfter","loginSuccess","loginFail","useBindPhoneValidate","handleSubmit","getIsMobileValid","rest","useCountDown","start","values","console","log","mobile","code","then","catch","isValid","Message","text","validationSchema","errorMessage","mobileValid","validate","valid","window","QC","Login","check","api","success","response","data","figureurl_1","__exports__","accountField","accountError","passwordField","passwordError","rePasswordField","rePasswordError","useRegisterPatch","getMobileIsValidate","checkUserAccount","password","rePassword","mobileValidate","components","LoginCallbackBindPatch","LoginCallbackBindPhone","LoginFooter","LoginHeader","getMe","openid","render"],"mappings":"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","file":"js/chunk-95b5ab78.a4e20590.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./LoginCallbackPatch.vue?vue&type=style&index=0&id=000d98bf&scoped=true&lang=less\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./LoginCallbackBindPhone.vue?vue&type=style&index=0&id=2dfcd29e&scoped=true&lang=less\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./LoginCallbackPage.vue?vue&type=style&index=0&id=4d350b2c&scoped=true&lang=less\"","<template>\n  <LoginHeader>联合登录</LoginHeader>\n  <section class=\"container\" v-if=\"loading\">\n    <div class=\"unbind\">\n      <div class=\"loading\"></div>\n    </div>\n  </section>\n  <!-- 如果当前没有处于加载状态, 说明加载完成, 加载完成以后如果用户没有绑定手机号 -->\n  <section class=\"container\" v-if=\"!loading && !isBind\">\n    <nav class=\"tab\">\n      <a\n        @click=\"hasAccount = true\"\n        :class=\"{ active: hasAccount }\"\n        href=\"javascript:\"\n      >\n        <i class=\"iconfont icon-bind\"></i>\n        <span>已有小兔鲜账号，请绑定手机</span>\n      </a>\n      <a\n        @click=\"hasAccount = false\"\n        :class=\"{ active: !hasAccount }\"\n        href=\"javascript:\"\n      >\n        <i class=\"iconfont icon-edit\"></i>\n        <span>没有小兔鲜账号，请完善资料</span>\n      </a>\n    </nav>\n    <div class=\"tab-content\" v-if=\"hasAccount\">\n      <LoginCallbackBindPhone :unionId=\"unionId\" />\n    </div>\n    <div class=\"tab-content\" v-else>\n      <LoginCallbackBindPatch :unionId=\"unionId\" />\n    </div>\n  </section>\n  <LoginFooter />\n</template>\n\n<script>\nimport LoginHeader from \"@/views/login/components/LoginHeader\";\nimport LoginFooter from \"@/views/login/components/LoginFooter\";\nimport LoginCallbackBindPhone from \"@/views/login/components/LoginCallbackBindPhone\";\nimport LoginCallbackBindPatch from \"@/views/login/components/LoginCallbackPatch\";\nimport { ref } from \"vue\";\nimport { findAccountByOpenId } from \"@/api/user\";\nimport useLoginAfter from \"@/hooks/useLoginAfter\";\nexport default {\n  name: \"LoginCallbackPage\",\n  components: {\n    LoginCallbackBindPatch,\n    LoginCallbackBindPhone,\n    LoginFooter,\n    LoginHeader,\n  },\n  setup() {\n    const hasAccount = ref(true);\n    // 1. 先假设QQ用户没有绑定小兔仙账号\n    const isBind = ref(false);\n    // 2. loading 状态\n    const loading = ref(false);\n    const { loginSuccess } = useLoginAfter();\n    // 用于存储 openid\n    const unionId = ref(\"\");\n    // 获取QQ登录用户的 openid\n    // 1. 检测用户的登录状态\n    if (window.QC.Login.check()) {\n      // 更新loading状态\n      loading.value = true;\n      // 获取 openid\n      window.QC.Login.getMe((openid) => {\n        // 存储 openid\n        unionId.value = openid;\n        // 向小兔仙应用的服务器发送请求 检测小兔仙账号\n        findAccountByOpenId({ unionId: openid })\n          // 如果检测到 直接跳转到首页 登录成功\n          .then((data) => {\n            // 更新加载状态\n            loading.value = false;\n            // 更新绑定状态\n            isBind.value = true;\n            loginSuccess(data);\n          })\n          .catch(() => {\n            // 如果没有检测到账号走 catch 方法\n            // 更新加载状态\n            loading.value = false;\n            // 更新绑定状态\n            isBind.value = false;\n          });\n      });\n    }\n    // 2. 拿着 access_token 向QQ互联发送请求换取用户的openid\n    return { hasAccount, isBind, loading, unionId };\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n.container {\n  padding: 25px 0;\n  position: relative;\n  height: 730px;\n  .unbind {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    padding: 25px 0;\n    z-index: 99;\n    .loading {\n      height: 100%;\n      background: #fff url(../../assets/images/load.gif) no-repeat center /\n        100px 100px;\n    }\n  }\n}\n.tab {\n  background: #fff;\n  height: 80px;\n  padding-top: 40px;\n  font-size: 18px;\n  text-align: center;\n  a {\n    color: #666;\n    display: inline-block;\n    width: 350px;\n    line-height: 40px;\n    border-bottom: 2px solid #e4e4e4;\n    i {\n      font-size: 22px;\n      vertical-align: middle;\n    }\n    span {\n      vertical-align: middle;\n      margin-left: 4px;\n    }\n    &.active {\n      color: @xtxColor;\n      border-color: @xtxColor;\n    }\n  }\n}\n.tab-content {\n  min-height: 600px;\n  background: #fff;\n}\n</style>\n","<template>\n  <form class=\"xtx-form\" @submit=\"onSubmit\">\n    <div class=\"user-info\">\n      <img :src=\"avatar\" alt=\"\" />\n      <p>Hi，{{ nickname }} 欢迎来小兔鲜，完成绑定后可以QQ账号一键登录哦~</p>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-phone\"></i>\n        <input\n          v-model=\"mobileField\"\n          class=\"input\"\n          type=\"text\"\n          placeholder=\"绑定的手机号\"\n        />\n      </div>\n      <div class=\"error\" v-if=\"mobileError\">{{ mobileError }}</div>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-code\"></i>\n        <input\n          v-model=\"codeField\"\n          class=\"input\"\n          type=\"text\"\n          placeholder=\"短信验证码\"\n        />\n        <span @click=\"getMsgCode\" :class=\"{ disabled: isActive }\" class=\"code\">\n          {{ isActive ? `剩余${count}秒` : \"发送验证码\" }}\n        </span>\n      </div>\n      <div class=\"error\" v-if=\"codeError\">{{ codeError }}</div>\n    </div>\n    <input type=\"submit\" class=\"submit\" value=\"立即绑定\" />\n  </form>\n</template>\n\n<script>\nimport { ref } from \"vue\";\nimport { useField, useForm } from \"vee-validate\";\nimport { mobile, code } from \"@/utils/vee-valiationSchema\";\nimport { bindMobileAndQQ, getMsgCodeWhenBindQQ } from \"@/api/user\";\nimport Message from \"@/components/library/Message\";\nimport useCountDown from \"@/hooks/useCountDown\";\nimport useLoginAfter from \"@/hooks/useLoginAfter\";\n\nexport default {\n  name: \"LoginCallbackBindPhone\",\n  props: {\n    unionId: {\n      type: String,\n    },\n  },\n  setup(props) {\n    // 获取QQ用户昵称和头像\n    const { nickname, avatar } = useQQUserInfo();\n    // 获取成功和登录失败之后的回调函数\n    const { loginSuccess, loginFail } = useLoginAfter();\n    const { handleSubmit, getIsMobileValid, ...rest } = useBindPhoneValidate();\n    // 获取倒计时\n    const { count, isActive, start } = useCountDown();\n    const onSubmit = handleSubmit((values) => {\n      console.log(values);\n      // 绑定手机号和QQ号\n      bindMobileAndQQ({\n        mobile: values.mobile,\n        code: values.code,\n        unionId: props.unionId,\n      })\n        .then(loginSuccess)\n        .catch(loginFail);\n    });\n    // 获取手机验证码\n    const getMsgCode = async () => {\n      // 1. 看看用户有没有输入手机号\n      let { isValid, mobile } = await getIsMobileValid();\n      // 用户输入了手机号 验证通过\n      if (isValid && !isActive.value) {\n        try {\n          // 2. 发送请求获取验证码\n          await getMsgCodeWhenBindQQ(mobile);\n          Message({ type: \"success\", text: \"验证码发送成功\" });\n          start(60);\n        } catch (error) {\n          Message({ type: \"error\", text: \"验证码发送失败\" });\n        }\n      }\n      // 3. 倒计时\n    };\n    return { nickname, avatar, ...rest, onSubmit, getMsgCode, count, isActive };\n  },\n};\n\nfunction useBindPhoneValidate() {\n  const { handleSubmit } = useForm({\n    validationSchema: { mobile, code },\n  });\n  const {\n    value: mobileField,\n    errorMessage: mobileError,\n    validate: mobileValid,\n  } = useField(\"mobile\");\n\n  // 单独验证用户是否输入手机号\n  const getIsMobileValid = async () => {\n    // 验证\n    let { valid } = await mobileValid();\n    return { isValid: valid, mobile: mobileField.value };\n  };\n\n  const { value: codeField, errorMessage: codeError } = useField(\"code\");\n  return {\n    handleSubmit,\n    mobileField,\n    mobileError,\n    codeField,\n    codeError,\n    getIsMobileValid,\n  };\n}\n\nfunction useQQUserInfo() {\n  // 用于存储用户昵称\n  const nickname = ref(\"\");\n  // 用于存储用户头像\n  const avatar = ref(\"\");\n  // 检测用户登录状态\n  if (window.QC.Login.check()) {\n    // 向腾讯服务器发送请求获取QQ用户信息\n    window.QC.api(\"get_user_info\").success((response) => {\n      // 存储用户昵称\n      nickname.value = response.data.nickname;\n      // 存储用户头像\n      avatar.value = response.data.figureurl_1;\n    });\n  }\n  // 返回用户昵称和用户头像\n  return { nickname, avatar };\n}\n</script>\n\n<style scoped lang=\"less\">\n.user-info {\n  width: 320px;\n  height: 70px;\n  display: flex;\n  background: #f2f2f2;\n  align-items: center;\n  padding: 0 10px;\n  margin: 0 auto 20px;\n  img {\n    background: #f2f2f2;\n    width: 50px;\n    height: 50px;\n  }\n  p {\n    padding-left: 10px;\n  }\n}\n.code {\n  position: absolute;\n  right: 0;\n  top: 0;\n  line-height: 50px;\n  width: 80px;\n  color: #999;\n  &:hover {\n    cursor: pointer;\n  }\n}\n</style>\n","import { render } from \"./LoginCallbackBindPhone.vue?vue&type=template&id=2dfcd29e&scoped=true\"\nimport script from \"./LoginCallbackBindPhone.vue?vue&type=script&lang=js\"\nexport * from \"./LoginCallbackBindPhone.vue?vue&type=script&lang=js\"\n\nimport \"./LoginCallbackBindPhone.vue?vue&type=style&index=0&id=2dfcd29e&scoped=true&lang=less\"\n\nimport exportComponent from \"/home/runner/work/Little-Rabbit-web/Little-Rabbit-web/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2dfcd29e\"]])\n\nexport default __exports__","<template>\n  <form class=\"xtx-form\" @submit=\"onSubmit\">\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-user\"></i>\n        <input\n          v-model=\"accountField\"\n          class=\"input\"\n          type=\"text\"\n          placeholder=\"请输入用户名\"\n        />\n      </div>\n      <div class=\"error\" v-if=\"accountError\">{{ accountError }}</div>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-phone\"></i>\n        <input\n          v-model=\"mobileField\"\n          class=\"input\"\n          type=\"text\"\n          placeholder=\"请输入手机号\"\n        />\n      </div>\n      <div class=\"error\" v-if=\"mobileError\">{{ mobileError }}</div>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-code\"></i>\n        <input\n          class=\"input\"\n          v-model=\"codeField\"\n          type=\"text\"\n          placeholder=\"请输入验证码\"\n        />\n        <span class=\"code\" @click=\"getMsgCode\">\n          {{ isActive ? `剩余${count}秒` : \"发送验证码\" }}\n        </span>\n      </div>\n      <div class=\"error\" v-if=\"codeError\">{{ codeError }}</div>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-lock\"></i>\n        <input\n          class=\"input\"\n          v-model=\"passwordField\"\n          type=\"password\"\n          placeholder=\"请输入密码\"\n        />\n      </div>\n      <div class=\"error\" v-if=\"passwordError\">{{ passwordError }}</div>\n    </div>\n    <div class=\"xtx-form-item\">\n      <div class=\"field\">\n        <i class=\"icon iconfont icon-lock\"></i>\n        <input\n          class=\"input\"\n          v-model=\"rePasswordField\"\n          type=\"password\"\n          placeholder=\"请确认密码\"\n        />\n      </div>\n      <div class=\"error\" v-if=\"rePasswordError\">{{ rePasswordError }}</div>\n    </div>\n    <input type=\"submit\" class=\"submit\" value=\"立即绑定\" />\n  </form>\n</template>\n\n<script>\nimport { useField, useForm } from \"vee-validate\";\nimport {\n  checkUserAccount,\n  code,\n  mobile,\n  password,\n  rePassword,\n} from \"@/utils/vee-valiationSchema\";\nimport { getMsgCodeByRegister, registerAndBindQQ } from \"@/api/user\";\nimport Message from \"@/components/library/Message\";\nimport useCountDown from \"@/hooks/useCountDown\";\nimport useLoginAfter from \"@/hooks/useLoginAfter\";\n\nexport default {\n  name: \"LoginCallbackBindPatch\",\n  props: {\n    unionId: {\n      type: String,\n    },\n  },\n  setup(props) {\n    const { handleSubmit, getMobileIsValidate, ...rest } = useRegisterPatch();\n    const { count, isActive, start } = useCountDown();\n    const { loginSuccess, loginFail } = useLoginAfter();\n    // 表单提交\n    const onSubmit = handleSubmit(\n      ({ checkUserAccount, mobile, code, password }) => {\n        // 向服务器端发送请求注册新账号并绑定新账号\n        registerAndBindQQ({\n          checkUserAccount,\n          mobile,\n          code,\n          password,\n          unionId: props.unionId,\n        }).then(loginSuccess, loginFail);\n      }\n    );\n\n    const getMsgCode = () => {\n      // 如果正在倒计时, 阻止程序向下运行\n      if (isActive.value) return;\n      // 1. 验证用户是否输入手机号\n      getMobileIsValidate()\n        .then(({ isValid, mobile }) => {\n          if (isValid) {\n            // 向服务器端发送请求获取验证码\n            return getMsgCodeByRegister(mobile);\n          }\n        })\n        .then(() => {\n          Message({ type: \"success\", text: \"验证码发送成功\" });\n          start(60);\n        })\n        .catch(() => {\n          Message({ type: \"error\", text: \"验证码发送失败\" });\n        });\n      // 2. 发送验证码\n      // 3. 用户提示\n    };\n    return { ...rest, onSubmit, getMsgCode, count, isActive };\n  },\n};\n\nfunction useRegisterPatch() {\n  const { handleSubmit } = useForm({\n    validationSchema: {\n      checkUserAccount,\n      mobile,\n      code,\n      rePassword,\n      password,\n    },\n  });\n\n  const { value: accountField, errorMessage: accountError } =\n    useField(\"checkUserAccount\");\n  const {\n    value: mobileField,\n    errorMessage: mobileError,\n    validate: mobileValidate,\n  } = useField(\"mobile\");\n  const { value: codeField, errorMessage: codeError } = useField(\"code\");\n  const { value: passwordField, errorMessage: passwordError } =\n    useField(\"password\");\n  const { value: rePasswordField, errorMessage: rePasswordError } =\n    useField(\"rePassword\");\n\n  const getMobileIsValidate = async () => {\n    let { valid } = await mobileValidate();\n    return { isValid: valid, mobile: mobileField.value };\n  };\n\n  return {\n    handleSubmit,\n    accountField,\n    accountError,\n    mobileField,\n    mobileError,\n    codeField,\n    codeError,\n    passwordField,\n    passwordError,\n    rePasswordField,\n    rePasswordError,\n    getMobileIsValidate,\n  };\n}\n</script>\n\n<style scoped lang=\"less\">\n.code {\n  position: absolute;\n  right: 0;\n  top: 0;\n  line-height: 50px;\n  width: 80px;\n  color: #999;\n  &:hover {\n    cursor: pointer;\n  }\n}\n</style>\n","import { render } from \"./LoginCallbackPatch.vue?vue&type=template&id=000d98bf&scoped=true\"\nimport script from \"./LoginCallbackPatch.vue?vue&type=script&lang=js\"\nexport * from \"./LoginCallbackPatch.vue?vue&type=script&lang=js\"\n\nimport \"./LoginCallbackPatch.vue?vue&type=style&index=0&id=000d98bf&scoped=true&lang=less\"\n\nimport exportComponent from \"/home/runner/work/Little-Rabbit-web/Little-Rabbit-web/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-000d98bf\"]])\n\nexport default __exports__","import { render } from \"./LoginCallbackPage.vue?vue&type=template&id=4d350b2c&scoped=true\"\nimport script from \"./LoginCallbackPage.vue?vue&type=script&lang=js\"\nexport * from \"./LoginCallbackPage.vue?vue&type=script&lang=js\"\n\nimport \"./LoginCallbackPage.vue?vue&type=style&index=0&id=4d350b2c&scoped=true&lang=less\"\n\nimport exportComponent from \"/home/runner/work/Little-Rabbit-web/Little-Rabbit-web/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4d350b2c\"]])\n\nexport default __exports__"],"sourceRoot":""}